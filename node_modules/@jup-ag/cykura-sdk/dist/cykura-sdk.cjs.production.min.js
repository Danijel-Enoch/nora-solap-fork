"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e,n=require("@cykura/sdk-core"),i=t(require("jsbi")),r=t(require("tiny-invariant")),a=require("@project-serum/anchor");function o(t,e,n,i,r,a,o){try{var u=t[a](o),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(i,r)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function u(t){o(a,i,r,u,s,"next",t)}function s(t){o(a,i,r,u,s,"throw",t)}u(void 0)}))}}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(){return(m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function l(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return p(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,void 0):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,g=new a.web3.PublicKey("cysPXAjehMpVKUapzbMCCnpFxUFFryEWEaLgnb9NrR8");(d=exports.FeeAmount||(exports.FeeAmount={}))[d.SUPER_STABLE=20]="SUPER_STABLE",d[d.TURBO_SPL=80]="TURBO_SPL",d[d.LOW=500]="LOW",d[d.MEDIUM=3e3]="MEDIUM",d[d.HIGH=1e4]="HIGH";var f=((e={})[exports.FeeAmount.SUPER_STABLE]=1,e[exports.FeeAmount.TURBO_SPL]=60,e[exports.FeeAmount.LOW]=10,e[exports.FeeAmount.MEDIUM]=60,e[exports.FeeAmount.HIGH]=200,e),y=i.BigInt(-1),h=i.BigInt(0),S=i.BigInt(1),k=i.exponentiate(i.BigInt(2),i.BigInt(32)),v=i.exponentiate(i.BigInt(2),i.BigInt(64)),x=i.subtract(k,S),A=i.subtract(v,S),M=i.BigInt(32),b=Buffer.from("b"),w=Buffer.from("p"),T=Buffer.from("ps"),q=Buffer.from("o"),I=Buffer.from("t"),P=Buffer.from("f");function O(t){var e=new ArrayBuffer(4);return new DataView(e).setUint32(0,t,!1),new Uint8Array(e)}function R(t){var e=t.factoryAddress,n=t.tokenA,i=t.tokenB,r=t.fee,o=n.sortsBefore(i)?[n,i]:[i,n],u=o[1],s=new a.web3.PublicKey(o[0].address),c=new a.web3.PublicKey(u.address);return a.web3.PublicKey.findProgramAddress([w,s.toBuffer(),c.toBuffer(),O(r)],e).then((function(t){return t[0]}))}var L=function(){function t(){}return t.addDelta=function(t,e){return i.lessThan(e,h)?i.subtract(t,i.multiply(e,y)):i.add(t,e)},t}(),C=function(){function t(){}return t.mulDivRoundingUp=function(t,e,n){var r=i.multiply(t,e),a=i.divide(r,n);return i.notEqual(i.remainder(r,n),h)&&(a=i.add(a,S)),a},t.mulDivFloor=function(t,e,n){i.notEqual(n,h)||r(!1);var a=i.multiply(t,e);return i.divide(a,n)},t.mulDivCeil=function(t,e,n){i.notEqual(n,h)||r(!1);var a=i.multiply(t,e);return i.divide(i.add(a,i.subtract(n,S)),n)},t}();function _(t,e){var r=i.multiply(t,e);return i.bitwiseAnd(r,n.MaxUint128)}var E=function(){function t(){}return t.getAmount0Delta=function(t,e,n,a){if(i.greaterThan(t,e)){var o=[e,t];t=o[0],e=o[1]}var u=i.leftShift(n,M),s=i.subtract(e,t);return i.greaterThan(t,h)||r(!1),a?C.mulDivRoundingUp(C.mulDivCeil(u,s,e),S,t):i.divide(C.mulDivFloor(u,s,e),t)},t.getAmount1Delta=function(t,e,n,r){if(i.greaterThan(t,e)){var a=[e,t];t=a[0],e=a[1]}return r?C.mulDivCeil(n,i.subtract(e,t),k):C.mulDivFloor(n,i.subtract(e,t),k)},t.getNextSqrtPriceFromInput=function(t,e,n,a){return i.greaterThan(t,h)||r(!1),i.greaterThan(e,h)||r(!1),a?this.getNextSqrtPriceFromAmount0RoundingUp(t,e,n,!0):this.getNextSqrtPriceFromAmount1RoundingDown(t,e,n,!0)},t.getNextSqrtPriceFromOutput=function(t,e,n,a){return i.greaterThan(t,h)||r(!1),i.greaterThan(e,h)||r(!1),a?this.getNextSqrtPriceFromAmount1RoundingDown(t,e,n,!1):this.getNextSqrtPriceFromAmount0RoundingUp(t,e,n,!1)},t.getNextSqrtPriceFromAmount0RoundingUp=function(t,e,a,o){if(i.equal(a,h))return t;var u=i.leftShift(e,M);if(o){var s=_(a,t),c=(p=i.add(u,s),i.bitwiseAnd(p,n.MaxUint128));return i.greaterThanOrEqual(c,u)?C.mulDivCeil(u,t,c):C.mulDivRoundingUp(u,S,i.add(i.divide(u,t),a))}var m=_(a,t);i.greaterThan(u,m)||r(!1);var p,l=i.subtract(u,m);return C.mulDivCeil(u,t,l)},t.getNextSqrtPriceFromAmount1RoundingDown=function(t,e,n,a){if(a){var o=i.lessThanOrEqual(n,x)?i.divide(i.leftShift(n,M),e):C.mulDivFloor(n,k,e);return i.add(t,o)}var u=i.lessThanOrEqual(n,x)?C.mulDivRoundingUp(i.leftShift(n,M),S,e):C.mulDivCeil(n,k,e);return i.greaterThan(t,u)||r(!1),i.subtract(t,u)},t}(),X=i.exponentiate(i.BigInt(10),i.BigInt(6)),N=function(){function t(){}return t.computeSwapStep=function(t,e,n,r,a){var o={},u=i.greaterThanOrEqual(t,e),s=i.greaterThanOrEqual(r,h);if(s){var c=C.mulDivFloor(r,i.subtract(X,i.BigInt(a)),X);o.amountIn=u?E.getAmount0Delta(e,t,n,!0):E.getAmount1Delta(t,e,n,!0),o.sqrtRatioNextX32=i.greaterThanOrEqual(c,o.amountIn)?e:E.getNextSqrtPriceFromInput(t,n,c,u)}else o.amountOut=u?E.getAmount1Delta(e,t,n,!1):E.getAmount0Delta(t,e,n,!1),o.sqrtRatioNextX32=i.greaterThanOrEqual(i.multiply(r,y),o.amountOut)?e:E.getNextSqrtPriceFromOutput(t,n,i.multiply(r,y),u);var m=i.equal(e,o.sqrtRatioNextX32);return u?(o.amountIn=m&&s?o.amountIn:E.getAmount0Delta(o.sqrtRatioNextX32,t,n,!0),o.amountOut=m&&!s?o.amountOut:E.getAmount1Delta(o.sqrtRatioNextX32,t,n,!1)):(o.amountIn=m&&s?o.amountIn:E.getAmount1Delta(t,o.sqrtRatioNextX32,n,!0),o.amountOut=m&&!s?o.amountOut:E.getAmount0Delta(t,o.sqrtRatioNextX32,n,!1)),!s&&i.greaterThan(o.amountOut,i.multiply(r,y))&&(o.amountOut=i.multiply(r,y)),o.feeAmount=s&&i.notEqual(o.sqrtRatioNextX32,e)?i.subtract(r,o.amountIn):C.mulDivCeil(o.amountIn,i.BigInt(a),i.subtract(X,i.BigInt(a))),[o.sqrtRatioNextX32,o.amountIn,o.amountOut,o.feeAmount]},t}();function U(t){return t.bitLength()-1}function B(t){return t.zeroBits()}function D(t,e){return i.signedRightShift(i.multiply(t,i.BigInt(e)),i.BigInt(64))}var F=i.exponentiate(i.BigInt(2),i.BigInt(32)),K=function(){function t(){}return t.getSqrtRatioAtTick=function(e){e>=t.MIN_TICK&&e<=t.MAX_TICK&&Number.isInteger(e)||r(!1);var a=e<0?-1*e:e,o=i.BigInt(0!=(1&a)?"0xfffcb933bd6fb800":"0x10000000000000000");return 0!=(2&a)&&(o=D(o,"0xfff97272373d4000")),0!=(4&a)&&(o=D(o,"0xfff2e50f5f657000")),0!=(8&a)&&(o=D(o,"0xffe5caca7e10f000")),0!=(16&a)&&(o=D(o,"0xffcb9843d60f7000")),0!=(32&a)&&(o=D(o,"0xff973b41fa98e800")),0!=(64&a)&&(o=D(o,"0xff2ea16466c9b000")),0!=(128&a)&&(o=D(o,"0xfe5dee046a9a3800")),0!=(256&a)&&(o=D(o,"0xfcbe86c7900bb000")),0!=(512&a)&&(o=D(o,"0xf987a7253ac65800")),0!=(1024&a)&&(o=D(o,"0xf3392b0822bb6000")),0!=(2048&a)&&(o=D(o,"0xe7159475a2caf000")),0!=(4096&a)&&(o=D(o,"0xd097f3bdfd2f2000")),0!=(8192&a)&&(o=D(o,"0xa9f746462d9f8000")),0!=(16384&a)&&(o=D(o,"0x70d869a156f31c00")),0!=(32768&a)&&(o=D(o,"0x31be135f97ed3200")),0!=(65536&a)&&(o=D(o,"0x9aa508b5b85a500")),0!=(131072&a)&&(o=D(o,"0x5d6af8dedc582c")),e>0&&(o=i.divide(n.MaxUint128,o)),i.greaterThan(i.remainder(o,F),h)?i.add(i.divide(o,F),S):i.divide(o,F)},t.getTickAtSqrtRatio=function(e){i.greaterThanOrEqual(e,t.MIN_SQRT_RATIO)&&i.lessThan(e,t.MAX_SQRT_RATIO)||r(!1);var n,o=U(new a.BN(e.toString()));n=i.greaterThanOrEqual(i.BigInt(o),i.BigInt(32))?i.signedRightShift(e,i.BigInt(o-31)):i.leftShift(e,i.BigInt(31-o));for(var u=i.leftShift(i.subtract(i.BigInt(o),i.BigInt(32)),i.BigInt(16)),s=0;s<14;s++){n=i.signedRightShift(i.multiply(n,n),i.BigInt(31));var c=i.signedRightShift(n,i.BigInt(32));u=i.bitwiseOr(u,i.leftShift(c,i.BigInt(15-s))),n=i.signedRightShift(n,c)}var m=i.multiply(u,i.BigInt("908567298")),p=i.toNumber(i.signedRightShift(i.subtract(m,i.BigInt("42949672")),i.BigInt(32))),l=i.toNumber(i.signedRightShift(i.add(m,i.BigInt("3677218864")),i.BigInt(32)));return p===l?p:i.lessThanOrEqual(t.getSqrtRatioAtTick(l),e)?l:p},t}();K.MIN_TICK=-221818,K.MAX_TICK=-K.MIN_TICK,K.MIN_SQRT_RATIO=i.BigInt("65537"),K.MAX_SQRT_RATIO=i.BigInt("281472331703918");var G=function(){function t(){}var e=t.prototype;return e.getTickAddress=function(t){throw new Error("Method not implemented.")},e.getTick=function(e){throw new Error(t.ERROR_MESSAGE)},e.nextInitializedTickWithinOneWord=function(e,n,i){throw new Error(t.ERROR_MESSAGE)},t}();G.ERROR_MESSAGE="No tick data provider was given";var W=new G,z=function(){function t(t,e,n,a,o,u,s){void 0===s&&(s=W),Number.isInteger(n)&&n<1e6||r(!1);var c=K.getSqrtRatioAtTick(u),m=K.getSqrtRatioAtTick(u+1);i.greaterThanOrEqual(a,c)&&i.lessThanOrEqual(a,m)||r(!1);var p=t.sortsBefore(e)?[t,e]:[e,t];this.token0=p[0],this.token1=p[1],this.fee=n,this.sqrtRatioX32=a,this.liquidity=o,this.tickCurrent=u,this.tickDataProvider=s}t.getAddress=function(t,e,n){return R({factoryAddress:g,fee:n,tokenA:t,tokenB:e})};var e=t.prototype;return e.involvesToken=function(t){return t.equals(this.token0)||t.equals(this.token1)},e.priceOf=function(t){return this.involvesToken(t)||r(!1),t.equals(this.token0)?this.token0Price:this.token1Price},e.getOutputAmount=function(e,a){this.involvesToken(e.currency)||r(!1);var o=e.currency.equals(this.token0),u=this.swap(o,e.quotient,a),s=u.sqrtRatioX32,c=u.liquidity,m=u.tickCurrent,p=u.accounts;return[n.CurrencyAmount.fromRawAmount(o?this.token1:this.token0,i.multiply(u.amountCalculated,y)),new t(this.token0,this.token1,this.fee,s,c,m,this.tickDataProvider),p]},e.getInputAmount=function(e,a){e.currency.isToken&&this.involvesToken(e.currency)||r(!1);var o=e.currency.equals(this.token1),u=this.swap(o,i.multiply(e.quotient,y),a),s=u.sqrtRatioX32,c=u.liquidity,m=u.tickCurrent;return[n.CurrencyAmount.fromRawAmount(o?this.token0:this.token1,u.amountCalculated),new t(this.token0,this.token1,this.fee,s,c,m,this.tickDataProvider)]},e.swap=function(t,e,n){i.notEqual(e,h)||r(!1),n||(n=t?i.add(K.MIN_SQRT_RATIO,S):i.subtract(K.MAX_SQRT_RATIO,S)),t?(i.greaterThan(n,K.MIN_SQRT_RATIO)||r(!1),i.lessThan(n,this.sqrtRatioX32)||r(!1)):(i.lessThan(n,K.MAX_SQRT_RATIO)||r(!1),i.greaterThan(n,this.sqrtRatioX32)||r(!1));for(var a,o=i.greaterThanOrEqual(e,h),u={amountSpecifiedRemaining:e,amountCalculated:h,sqrtPriceX32:this.sqrtRatioX32,tick:this.tickCurrent,accounts:[],liquidity:this.liquidity},s=0;i.notEqual(u.amountSpecifiedRemaining,h)&&u.sqrtPriceX32!=n&&u.tick<K.MAX_TICK&&u.tick>K.MIN_TICK;){if(s>8)throw Error("account limit");var c={};c.sqrtPriceStartX32=u.sqrtPriceX32;var m=this.tickDataProvider.nextInitializedTickWithinOneWord(u.tick,t,this.tickSpacing);c.tickNext=m[0],c.initialized=m[1];var p=m[2];a!==p&&(u.accounts.push({pubkey:m[4],isWritable:!1,isSigner:!1}),a=p),c.tickNext<K.MIN_TICK?c.tickNext=K.MIN_TICK:c.tickNext>K.MAX_TICK&&(c.tickNext=K.MAX_TICK),c.sqrtPriceNextX32=K.getSqrtRatioAtTick(c.tickNext);var l=N.computeSwapStep(u.sqrtPriceX32,(t?i.lessThan(c.sqrtPriceNextX32,n):i.greaterThan(c.sqrtPriceNextX32,n))?n:c.sqrtPriceNextX32,u.liquidity,u.amountSpecifiedRemaining,this.fee);if(u.sqrtPriceX32=l[0],c.amountIn=l[1],c.amountOut=l[2],c.feeAmount=l[3],o?(u.amountSpecifiedRemaining=i.subtract(u.amountSpecifiedRemaining,i.add(c.amountIn,c.feeAmount)),u.amountCalculated=i.subtract(u.amountCalculated,c.amountOut)):(u.amountSpecifiedRemaining=i.add(u.amountSpecifiedRemaining,c.amountOut),u.amountCalculated=i.add(u.amountCalculated,i.add(c.amountIn,c.feeAmount))),i.equal(u.sqrtPriceX32,c.sqrtPriceNextX32)){if(c.initialized){var d=this.tickDataProvider.getTick(c.tickNext);u.accounts.push({pubkey:d.address,isWritable:!0,isSigner:!1});var g=d.liquidityNet;t&&(g=i.multiply(g,y)),u.liquidity=L.addDelta(u.liquidity,g)}u.tick=t?c.tickNext-1:c.tickNext}else u.sqrtPriceX32!=c.sqrtPriceStartX32&&(u.tick=K.getTickAtSqrtRatio(u.sqrtPriceX32));++s}return{amountCalculated:u.amountCalculated,sqrtRatioX32:u.sqrtPriceX32,liquidity:u.liquidity,tickCurrent:u.tick,accounts:u.accounts}},c(t,[{key:"token0Price",get:function(){var t;return null!=(t=this._token0Price)?t:this._token0Price=new n.Price(this.token0,this.token1,v,i.multiply(this.sqrtRatioX32,this.sqrtRatioX32))}},{key:"token1Price",get:function(){var t;return null!=(t=this._token1Price)?t:this._token1Price=new n.Price(this.token1,this.token0,i.multiply(this.sqrtRatioX32,this.sqrtRatioX32),v)}},{key:"chainId",get:function(){return this.token0.chainId}},{key:"tickSpacing",get:function(){return f[this.fee]}}]),t}();function j(t,e,n){if(i.greaterThan(t,e)){var r=[e,t];t=r[0],e=r[1]}var a=C.mulDivFloor(t,e,x);return C.mulDivFloor(i.BigInt(n),a,i.subtract(e,t))}function H(t,e,n){if(i.greaterThan(t,e)){var r=[e,t];t=r[0],e=r[1]}return C.mulDivFloor(i.BigInt(n),x,i.subtract(e,t))}function Q(t,e,n,r,a,o){if(i.greaterThan(e,n)){var u=[n,e];e=u[0],n=u[1]}var s=j;if(i.lessThanOrEqual(t,e))return s(e,n,r);if(i.lessThan(t,n)){var c=s(t,n,r),m=H(e,t,a);return i.lessThan(c,m)?c:m}return H(e,n,a)}function V(t,e){var r=i.leftShift(i.BigInt(t),i.BigInt(64)),a=i.BigInt(e),o=i.divide(r,a);return n.sqrt(o)}function Y(t,e,r){var a=K.getSqrtRatioAtTick(r),o=i.multiply(a,a);return t.sortsBefore(e)?new n.Price(t,e,v,o):new n.Price(t,e,o,v)}var Z=function(){function t(t){var e=t.pool,n=t.liquidity,a=t.tickLower,o=t.tickUpper;this._token0Amount=null,this._token1Amount=null,this._mintAmounts=null,a<o||r(!1),a>=K.MIN_TICK&&a%e.tickSpacing==0||r(!1),o<=K.MAX_TICK&&o%e.tickSpacing==0||r(!1),this.pool=e,this.tickLower=a,this.tickUpper=o,this.liquidity=i.BigInt(n)}var e=t.prototype;return e.ratiosAfterSlippage=function(t){var e=this.pool.token0Price.asFraction.multiply(new n.Percent(1).subtract(t)),r=this.pool.token0Price.asFraction.multiply(t.add(1)),a=V(e.numerator,e.denominator);i.lessThanOrEqual(a,K.MIN_SQRT_RATIO)&&(a=i.add(K.MIN_SQRT_RATIO,i.BigInt(1)));var o=V(r.numerator,r.denominator);return i.greaterThanOrEqual(o,K.MAX_SQRT_RATIO)&&(o=i.subtract(K.MAX_SQRT_RATIO,i.BigInt(1))),{sqrtRatioX32Lower:a,sqrtRatioX32Upper:o}},e.mintAmountsWithSlippage=function(e){var n=this.ratiosAfterSlippage(e),r=n.sqrtRatioX32Upper,a=n.sqrtRatioX32Lower,o=new z(this.pool.token0,this.pool.token1,this.pool.fee,a,i.BigInt(0),K.getTickAtSqrtRatio(a)),u=new z(this.pool.token0,this.pool.token1,this.pool.fee,r,i.BigInt(0),K.getTickAtSqrtRatio(r)),s=t.fromAmounts(m({pool:this.pool,tickLower:this.tickLower,tickUpper:this.tickUpper},this.mintAmounts,{useFullPrecision:!1}));return{amount0:new t({pool:u,liquidity:s.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).mintAmounts.amount0,amount1:new t({pool:o,liquidity:s.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).mintAmounts.amount1}},e.burnAmountsWithSlippage=function(e){var n=this.ratiosAfterSlippage(e),r=n.sqrtRatioX32Upper,a=n.sqrtRatioX32Lower,o=new z(this.pool.token0,this.pool.token1,this.pool.fee,a,i.BigInt(0),K.getTickAtSqrtRatio(a)),u=new t({pool:new z(this.pool.token0,this.pool.token1,this.pool.fee,r,i.BigInt(0),K.getTickAtSqrtRatio(r)),liquidity:this.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).amount0,s=new t({pool:o,liquidity:this.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).amount1;return{amount0:u.quotient,amount1:s.quotient}},t.fromAmounts=function(e){var n=e.pool,i=e.tickLower,r=e.tickUpper,a=e.amount0,o=e.amount1,u=K.getSqrtRatioAtTick(i),s=K.getSqrtRatioAtTick(r);return new t({pool:n,tickLower:i,tickUpper:r,liquidity:Q(n.sqrtRatioX32,u,s,a,o)})},t.fromAmount0=function(e){return t.fromAmounts({pool:e.pool,tickLower:e.tickLower,tickUpper:e.tickUpper,amount0:e.amount0,amount1:A,useFullPrecision:e.useFullPrecision})},t.fromAmount1=function(e){return t.fromAmounts({pool:e.pool,tickLower:e.tickLower,tickUpper:e.tickUpper,amount0:A,amount1:e.amount1,useFullPrecision:!0})},c(t,[{key:"token0PriceLower",get:function(){return Y(this.pool.token0,this.pool.token1,this.tickLower)}},{key:"token0PriceUpper",get:function(){return Y(this.pool.token0,this.pool.token1,this.tickUpper)}},{key:"amount0",get:function(){return null===this._token0Amount&&(this._token0Amount=n.CurrencyAmount.fromRawAmount(this.pool.token0,this.pool.tickCurrent<this.tickLower?E.getAmount0Delta(K.getSqrtRatioAtTick(this.tickLower),K.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!1):this.pool.tickCurrent<this.tickUpper?E.getAmount0Delta(this.pool.sqrtRatioX32,K.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!1):h)),this._token0Amount}},{key:"amount1",get:function(){return null===this._token1Amount&&(this._token1Amount=n.CurrencyAmount.fromRawAmount(this.pool.token1,this.pool.tickCurrent<this.tickLower?h:E.getAmount1Delta(K.getSqrtRatioAtTick(this.tickLower),this.pool.tickCurrent<this.tickUpper?this.pool.sqrtRatioX32:K.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!1))),this._token1Amount}},{key:"mintAmounts",get:function(){return null===this._mintAmounts?this.pool.tickCurrent<this.tickLower?{amount0:E.getAmount0Delta(K.getSqrtRatioAtTick(this.tickLower),K.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!0),amount1:h}:this.pool.tickCurrent<this.tickUpper?{amount0:E.getAmount0Delta(this.pool.sqrtRatioX32,K.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!0),amount1:E.getAmount1Delta(K.getSqrtRatioAtTick(this.tickLower),this.pool.sqrtRatioX32,this.liquidity,!0)}:{amount0:h,amount1:E.getAmount1Delta(K.getSqrtRatioAtTick(this.tickLower),K.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!0)}:this._mintAmounts}}]),t}(),$=function(){function t(t,e,n){this._midPrice=null,t.length>0||r(!1);var i=t[0].chainId;t.every((function(t){return t.chainId===i}))||r(!1);var a=e.wrapped;t[0].involvesToken(a)||r(!1),t[t.length-1].involvesToken(n.wrapped)||r(!1);for(var o,u=[a],s=l(t.entries());!(o=s()).done;){var c=o.value,m=c[1],p=u[c[0]];p.equals(m.token0)||p.equals(m.token1)||r(!1);var d=p.equals(m.token0)?m.token1:m.token0;u.push(d)}this.pools=t,this.tokenPath=u,this.input=e,this.output=null!=n?n:u[u.length-1]}return c(t,[{key:"chainId",get:function(){return this.pools[0].chainId}},{key:"midPrice",get:function(){if(null!==this._midPrice)return this._midPrice;var t=this.pools.slice(1).reduce((function(t,e){var n=t.price;return t.nextInput.equals(e.token0)?{nextInput:e.token1,price:n.multiply(e.token0Price)}:{nextInput:e.token0,price:n.multiply(e.token1Price)}}),this.pools[0].token0.equals(this.input.wrapped)?{nextInput:this.pools[0].token1,price:this.pools[0].token0Price}:{nextInput:this.pools[0].token0,price:this.pools[0].token1Price}).price;return this._midPrice=new n.Price(this.input,this.output,t.denominator,t.numerator)}}]),t}();function J(t,e){for(var n=0;n<t.length-1;n++)if(e(t[n],t[n+1])>0)return!1;return!0}function tt(t,e){return t.index-e.index}var et=function(){function t(){}return t.validateList=function(t,e){e>0||r(!1),t.every((function(t){return t.index%e==0}))||r(!1),i.equal(t.reduce((function(t,e){return i.add(t,e.liquidityNet)}),h),h)||r(!1),J(t,tt)||r(!1)},t.isBelowSmallest=function(t,e){return t.length>0||r(!1),e<t[0].index},t.isAtOrAboveLargest=function(t,e){return t.length>0||r(!1),e>=t[t.length-1].index},t.getTick=function(t,e){var n=t[this.binarySearch(t,e)];return n.index!==e&&r(!1),n},t.binarySearch=function(t,e){this.isBelowSmallest(t,e)&&r(!1);for(var n,i=0,a=t.length-1;;){if(t[n=Math.floor((i+a)/2)].index<=e&&(n===t.length-1||t[n+1].index>e))return n;t[n].index<e?i=n+1:a=n-1}},t.nextInitializedTick=function(e,n,i){return i?(t.isBelowSmallest(e,n)&&r(!1),t.isAtOrAboveLargest(e,n)?e[e.length-1]:e[this.binarySearch(e,n)]):(this.isAtOrAboveLargest(e,n)&&r(!1),this.isBelowSmallest(e,n)?e[0]:e[this.binarySearch(e,n)+1])},t.nextInitializedTickWithinOneWord=function(e,n,i,r){var a=Math.floor(n/r);if(i){var o=(a>>8<<8)*r;if(t.isBelowSmallest(e,n))return[o,!1];var u=t.nextInitializedTick(e,n,i).index,s=Math.max(o,u);return[s,s===u]}var c=(1+(a+1>>8)<<8)*r-1;if(this.isAtOrAboveLargest(e,n))return[c,!1];var m=this.nextInitializedTick(e,n,i).index,p=Math.min(c,m);return[p,p===m]},t}();function nt(t){var e=t.observation,n=t.tick,i=t.liquidity,r=t.blockTimestamp.sub(e.blockTimestamp);return m({},e,{tickCumulative:e.tickCumulative.add(n.mul(r)),secondsPerLiquidityCumulativeX32:e.secondsPerLiquidityCumulativeX32.add(r.shln(32).div(i.gtn(0)?i:new a.BN(1))),initialized:!0})}var it,rt=(function(t){var e=function(t){var e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function s(t,e,n,i){var r=Object.create((e&&e.prototype instanceof p?e:p).prototype),a=new M(i||[]);return r._invoke=function(t,e,n){var i="suspendedStart";return function(r,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw a;return{value:void 0,done:!0}}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var u=v(o,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var s=c(t,e,n);if("normal"===s.type){if(i=n.done?"completed":"suspendedYield",s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(i="completed",n.method="throw",n.arg=s.arg)}}}(t,n,a),r}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var m={};function p(){}function l(){}function d(){}var g={};u(g,r,(function(){return this}));var f=Object.getPrototypeOf,y=f&&f(f(b([])));y&&y!==e&&n.call(y,r)&&(g=y);var h=d.prototype=p.prototype=Object.create(g);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){var i;this._invoke=function(r,a){function o(){return new e((function(i,o){!function i(r,a,o,u){var s=c(t[r],t,a);if("throw"!==s.type){var m=s.arg,p=m.value;return p&&"object"==typeof p&&n.call(p,"__await")?e.resolve(p.__await).then((function(t){i("next",t,o,u)}),(function(t){i("throw",t,o,u)})):e.resolve(p).then((function(t){m.value=t,o(m)}),(function(t){return i("throw",t,o,u)}))}u(s.arg)}(r,a,i,o)}))}return i=i?i.then(o,o):o()}}function v(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,v(t,e),"throw"===e.method))return m;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=c(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,m;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,m):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function b(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:w}}function w(){return{value:void 0,done:!0}}return l.prototype=d,u(h,"constructor",d),u(d,"constructor",l),l.displayName=u(d,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===l||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,o,"GeneratorFunction")),t.prototype=Object.create(h),t},t.awrap=function(t){return{__await:t}},S(k.prototype),u(k.prototype,a,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,i,r,a){void 0===a&&(a=Promise);var o=new k(s(e,n,i,r),a);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(h),u(h,o,"Generator"),u(h,r,(function(){return this})),u(h,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=b,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return o.type="throw",o.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;A(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(it={exports:{}}),it.exports);function at(t,e){return t.inputAmount.currency.equals(e.inputAmount.currency)||r(!1),t.outputAmount.currency.equals(e.outputAmount.currency)||r(!1),t.outputAmount.equalTo(e.outputAmount)?t.inputAmount.equalTo(e.inputAmount)?t.swaps.reduce((function(t,e){return t+e.route.tokenPath.length}),0)-e.swaps.reduce((function(t,e){return t+e.route.tokenPath.length}),0):t.inputAmount.lessThan(e.inputAmount)?-1:1:t.outputAmount.lessThan(e.outputAmount)?1:-1}var ot=function(){function t(t){var e=t.routes,n=t.tradeType,i=e[0].inputAmount.currency,a=e[0].outputAmount.currency;e.every((function(t){return i.wrapped.equals(t.route.input.wrapped)}))||r(!1),e.every((function(t){return a.wrapped.equals(t.route.output.wrapped)}))||r(!1),this.swaps=e,this.tradeType=n}t.exactIn=function(){var e=u(rt.mark((function e(i,r){return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.fromRoute(i,r,n.TradeType.EXACT_INPUT));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.exactOut=function(){var e=u(rt.mark((function e(i,r){return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.fromRoute(i,r,n.TradeType.EXACT_OUTPUT));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.fromRoute=function(){var e=u(rt.mark((function e(i,a,o){var u,s,c,m,p,l,d;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=new Array(i.tokenPath.length),o!==n.TradeType.EXACT_INPUT){e.next=19;break}a.currency.equals(i.input)||r(!1),u[0]=a.wrapped,m=0;case 5:if(!(m<i.tokenPath.length-1)){e.next=15;break}return p=i.pools[m],e.next=9,p.getOutputAmount(u[m]);case 9:u[m+1]=e.sent[0];case 12:m++,e.next=5;break;case 15:s=n.CurrencyAmount.fromFractionalAmount(i.input,a.numerator,a.denominator),c=n.CurrencyAmount.fromFractionalAmount(i.output,u[u.length-1].numerator,u[u.length-1].denominator),e.next=34;break;case 19:a.currency.equals(i.output)||r(!1),u[u.length-1]=a.wrapped,l=i.tokenPath.length-1;case 22:if(!(l>0)){e.next=32;break}return d=i.pools[l-1],e.next=26,d.getInputAmount(u[l]);case 26:u[l-1]=e.sent[0];case 29:l--,e.next=22;break;case 32:s=n.CurrencyAmount.fromFractionalAmount(i.input,u[0].numerator,u[0].denominator),c=n.CurrencyAmount.fromFractionalAmount(i.output,a.numerator,a.denominator);case 34:return e.abrupt("return",new t({routes:[{inputAmount:s,outputAmount:c,route:i}],tradeType:o}));case 35:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),t.fromRoutes=function(){var e=u(rt.mark((function e(i,a){var o,u,s,c,m,p,d,g,f,y,h,S,k;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=[],u=l(i);case 2:if((s=u()).done){e.next=43;break}if(m=(c=s.value).route,p=c.amount,d=new Array(m.tokenPath.length),g=void 0,f=void 0,a!==n.TradeType.EXACT_INPUT){e.next=25;break}p.currency.equals(m.input)||r(!1),g=n.CurrencyAmount.fromFractionalAmount(m.input,p.numerator,p.denominator),d[0]=n.CurrencyAmount.fromFractionalAmount(m.input.wrapped,p.numerator,p.denominator),y=0;case 12:if(!(y<m.tokenPath.length-1)){e.next=22;break}return h=m.pools[y],e.next=16,h.getOutputAmount(d[y]);case 16:d[y+1]=e.sent[0];case 19:y++,e.next=12;break;case 22:f=n.CurrencyAmount.fromFractionalAmount(m.output,d[d.length-1].numerator,d[d.length-1].denominator),e.next=40;break;case 25:p.currency.equals(m.output)||r(!1),f=n.CurrencyAmount.fromFractionalAmount(m.output,p.numerator,p.denominator),d[d.length-1]=n.CurrencyAmount.fromFractionalAmount(m.output.wrapped,p.numerator,p.denominator),S=m.tokenPath.length-1;case 29:if(!(S>0)){e.next=39;break}return k=m.pools[S-1],e.next=33,k.getInputAmount(d[S]);case 33:d[S-1]=e.sent[0];case 36:S--,e.next=29;break;case 39:g=n.CurrencyAmount.fromFractionalAmount(m.input,d[0].numerator,d[0].denominator);case 40:o.push({route:m,inputAmount:g,outputAmount:f});case 41:e.next=2;break;case 43:return e.abrupt("return",new t({routes:o,tradeType:a}));case 44:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.createUncheckedTrade=function(e){return new t(m({},e,{routes:[{inputAmount:e.inputAmount,outputAmount:e.outputAmount,route:e.route}]}))},t.createUncheckedTradeWithMultipleRoutes=function(e){return new t(e)};var e=t.prototype;return e.minimumAmountOut=function(t,e){if(void 0===e&&(e=this.outputAmount),t.lessThan("0")&&r(!1),this.tradeType===n.TradeType.EXACT_OUTPUT)return e;var i=new n.Fraction("1").add(t).invert().multiply(e.quotient).quotient;return n.CurrencyAmount.fromRawAmount(e.currency,i)},e.maximumAmountIn=function(t,e){if(void 0===e&&(e=this.inputAmount),t.lessThan("0")&&r(!1),this.tradeType===n.TradeType.EXACT_INPUT)return e;var i=new n.Fraction("1").add(t).multiply(e.quotient).quotient;return n.CurrencyAmount.fromRawAmount(e.currency,i)},e.worstExecutionPrice=function(t){return new n.Price(this.inputAmount.currency,this.outputAmount.currency,this.maximumAmountIn(t).quotient,this.minimumAmountOut(t).quotient)},t.bestTradeExactIn=function(){var e=u(rt.mark((function e(i,a,o,u,s,c,m){var p,l,d,g,f,y,h,S,k,v,x;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d=void 0===(l=(p=void 0===u?{}:u).maxNumResults)?3:l,f=void 0===(g=p.maxHops)?3:g,void 0===s&&(s=[]),void 0===c&&(c=a),void 0===m&&(m=[]),i.length>0||r(!1),f>0||r(!1),a===c||s.length>0||r(!1),y=c.wrapped,h=o.wrapped,S=0;case 10:if(!(S<i.length)){e.next=46;break}if((k=i[S]).token0.equals(y.currency)||k.token1.equals(y.currency)){e.next=14;break}return e.abrupt("continue",43);case 14:return v=void 0,e.prev=15,e.next=19,k.getOutputAmount(y);case 19:v=e.sent[0],e.next=28;break;case 23:if(e.prev=23,e.t0=e.catch(15),!e.t0.isInsufficientInputAmountError){e.next=27;break}return e.abrupt("continue",43);case 27:throw e.t0;case 28:if(!v.currency.isToken||!v.currency.equals(h)){e.next=39;break}return e.t1=n.sortedInsert,e.t2=m,e.next=33,t.fromRoute(new $([].concat(s,[k]),a.currency,o),a,n.TradeType.EXACT_INPUT);case 33:e.t3=e.sent,e.t4=d,e.t5=at,(0,e.t1)(e.t2,e.t3,e.t4,e.t5),e.next=43;break;case 39:if(!(f>1&&i.length>1)){e.next=43;break}return x=i.slice(0,S).concat(i.slice(S+1,i.length)),e.next=43,t.bestTradeExactIn(x,a,o,{maxNumResults:d,maxHops:f-1},[].concat(s,[k]),v,m);case 43:S++,e.next=10;break;case 46:return e.abrupt("return",m);case 47:case"end":return e.stop()}}),e,null,[[15,23]])})));return function(t,n,i,r,a,o,u){return e.apply(this,arguments)}}(),t.bestTradeExactOut=function(){var e=u(rt.mark((function e(i,a,o,u,s,c,m){var p,l,d,g,f,y,h,S,k,v,x;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d=void 0===(l=(p=void 0===u?{}:u).maxNumResults)?3:l,f=void 0===(g=p.maxHops)?3:g,void 0===s&&(s=[]),void 0===c&&(c=o),void 0===m&&(m=[]),i.length>0||r(!1),f>0||r(!1),o===c||s.length>0||r(!1),y=c.wrapped,h=a.wrapped,S=0;case 10:if(!(S<i.length)){e.next=46;break}if((k=i[S]).token0.equals(y.currency)||k.token1.equals(y.currency)){e.next=14;break}return e.abrupt("continue",43);case 14:return v=void 0,e.prev=15,e.next=19,k.getInputAmount(y);case 19:v=e.sent[0],e.next=28;break;case 23:if(e.prev=23,e.t0=e.catch(15),!e.t0.isInsufficientReservesError){e.next=27;break}return e.abrupt("continue",43);case 27:throw e.t0;case 28:if(!v.currency.equals(h)){e.next=39;break}return e.t1=n.sortedInsert,e.t2=m,e.next=33,t.fromRoute(new $([k].concat(s),a,o.currency),o,n.TradeType.EXACT_OUTPUT);case 33:e.t3=e.sent,e.t4=d,e.t5=at,(0,e.t1)(e.t2,e.t3,e.t4,e.t5),e.next=43;break;case 39:if(!(f>1&&i.length>1)){e.next=43;break}return x=i.slice(0,S).concat(i.slice(S+1,i.length)),e.next=43,t.bestTradeExactOut(x,a,o,{maxNumResults:d,maxHops:f-1},[k].concat(s),v,m);case 43:S++,e.next=10;break;case 46:return e.abrupt("return",m);case 47:case"end":return e.stop()}}),e,null,[[15,23]])})));return function(t,n,i,r,a,o,u){return e.apply(this,arguments)}}(),c(t,[{key:"route",get:function(){return 1!=this.swaps.length&&r(!1),this.swaps[0].route}},{key:"inputAmount",get:function(){if(this._inputAmount)return this._inputAmount;var t=this.swaps[0].inputAmount.currency,e=this.swaps.map((function(t){return t.inputAmount})).reduce((function(t,e){return t.add(e)}),n.CurrencyAmount.fromRawAmount(t,0));return this._inputAmount=e,this._inputAmount}},{key:"outputAmount",get:function(){if(this._outputAmount)return this._outputAmount;var t=this.swaps[0].outputAmount.currency,e=this.swaps.map((function(t){return t.outputAmount})).reduce((function(t,e){return t.add(e)}),n.CurrencyAmount.fromRawAmount(t,0));return this._outputAmount=e,this._outputAmount}},{key:"executionPrice",get:function(){var t;return null!=(t=this._executionPrice)?t:this._executionPrice=new n.Price(this.inputAmount.currency,this.outputAmount.currency,this.inputAmount.quotient,this.outputAmount.quotient)}},{key:"priceImpact",get:function(){if(this._priceImpact)return this._priceImpact;for(var t,e=n.CurrencyAmount.fromRawAmount(this.outputAmount.currency,0),i=l(this.swaps);!(t=i()).done;){var r=t.value;e=e.add(r.route.midPrice.quote(r.inputAmount))}var a=e.subtract(this.outputAmount).divide(e);return this._priceImpact=new n.Percent(a.numerator,a.denominator),this._priceImpact}}]),t}();exports.ADDRESS_ZERO="0x0000000000000000000000000000000000000000",exports.BITMAP_SEED=b,exports.FACTORY_ADDRESS=g,exports.FEE_SEED=P,exports.FullMath=C,exports.IDL={version:"0.1.6",name:"cyclos_core",instructions:[{name:"initFactory",accounts:[{name:"owner",isMut:!0,isSigner:!0},{name:"factoryState",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"setOwner",accounts:[{name:"owner",isMut:!1,isSigner:!0},{name:"newOwner",isMut:!1,isSigner:!1},{name:"factoryState",isMut:!0,isSigner:!1}],args:[]},{name:"enableFeeAmount",accounts:[{name:"owner",isMut:!0,isSigner:!0},{name:"factoryState",isMut:!0,isSigner:!1},{name:"feeState",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"fee",type:"u32"},{name:"tickSpacing",type:"u16"}]},{name:"createAndInitPool",accounts:[{name:"poolCreator",isMut:!0,isSigner:!0},{name:"token0",isMut:!1,isSigner:!1},{name:"token1",isMut:!1,isSigner:!1},{name:"feeState",isMut:!1,isSigner:!1},{name:"poolState",isMut:!0,isSigner:!1},{name:"initialObservationState",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"sqrtPriceX32",type:"u64"}]},{name:"increaseObservationCardinalityNext",accounts:[{name:"payer",isMut:!1,isSigner:!0},{name:"poolState",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"observationAccountBumps",type:"bytes"}]},{name:"setFeeProtocol",accounts:[{name:"owner",isMut:!1,isSigner:!0},{name:"factoryState",isMut:!0,isSigner:!1}],args:[{name:"feeProtocol",type:"u8"}]},{name:"collectProtocol",accounts:[{name:"owner",isMut:!1,isSigner:!0},{name:"factoryState",isMut:!0,isSigner:!1},{name:"poolState",isMut:!0,isSigner:!1},{name:"vault0",isMut:!0,isSigner:!1},{name:"vault1",isMut:!0,isSigner:!1},{name:"recipientWallet0",isMut:!0,isSigner:!1},{name:"recipientWallet1",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"amount0Requested",type:"u64"},{name:"amount1Requested",type:"u64"}]},{name:"initTickAccount",accounts:[{name:"signer",isMut:!0,isSigner:!0},{name:"poolState",isMut:!1,isSigner:!1},{name:"tickState",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"tick",type:"i32"}]},{name:"closeTickAccount",accounts:[{name:"tickState",isMut:!0,isSigner:!1},{name:"recipient",isMut:!0,isSigner:!1}],args:[]},{name:"initBitmapAccount",accounts:[{name:"signer",isMut:!0,isSigner:!0},{name:"poolState",isMut:!1,isSigner:!1},{name:"bitmapState",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"wordPos",type:"i16"}]},{name:"initPositionAccount",accounts:[{name:"signer",isMut:!0,isSigner:!0},{name:"recipient",isMut:!1,isSigner:!1},{name:"poolState",isMut:!1,isSigner:!1},{name:"tickLowerState",isMut:!1,isSigner:!1},{name:"tickUpperState",isMut:!1,isSigner:!1},{name:"positionState",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"mintCallback",accounts:[{name:"minter",isMut:!1,isSigner:!0},{name:"tokenAccount0",isMut:!1,isSigner:!1},{name:"tokenAccount1",isMut:!1,isSigner:!1},{name:"vault0",isMut:!1,isSigner:!1},{name:"vault1",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"amount0Owed",type:"u64"},{name:"amount1Owed",type:"u64"}]},{name:"swapCallback",accounts:[{name:"signer",isMut:!1,isSigner:!0},{name:"inputTokenAccount",isMut:!0,isSigner:!1},{name:"outputTokenAccount",isMut:!0,isSigner:!1},{name:"inputVault",isMut:!0,isSigner:!1},{name:"outputVault",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"amount0Delta",type:"i64"},{name:"amount1Delta",type:"i64"}]},{name:"mint",accounts:[{name:"minter",isMut:!1,isSigner:!0},{name:"tokenAccount0",isMut:!0,isSigner:!1},{name:"tokenAccount1",isMut:!0,isSigner:!1},{name:"vault0",isMut:!0,isSigner:!1},{name:"vault1",isMut:!0,isSigner:!1},{name:"recipient",isMut:!1,isSigner:!1},{name:"poolState",isMut:!0,isSigner:!1},{name:"tickLowerState",isMut:!0,isSigner:!1},{name:"tickUpperState",isMut:!0,isSigner:!1},{name:"bitmapLowerState",isMut:!0,isSigner:!1},{name:"bitmapUpperState",isMut:!0,isSigner:!1},{name:"positionState",isMut:!0,isSigner:!1},{name:"lastObservationState",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"callbackHandler",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]},{name:"burn",accounts:[{name:"owner",isMut:!1,isSigner:!0},{name:"poolState",isMut:!0,isSigner:!1},{name:"tickLowerState",isMut:!1,isSigner:!1},{name:"tickUpperState",isMut:!1,isSigner:!1},{name:"bitmapLowerState",isMut:!1,isSigner:!1},{name:"bitmapUpperState",isMut:!1,isSigner:!1},{name:"positionState",isMut:!0,isSigner:!1},{name:"lastObservationState",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]},{name:"collect",accounts:[{name:"owner",isMut:!1,isSigner:!0},{name:"poolState",isMut:!0,isSigner:!1},{name:"tickLowerState",isMut:!1,isSigner:!1},{name:"tickUpperState",isMut:!1,isSigner:!1},{name:"positionState",isMut:!0,isSigner:!1},{name:"vault0",isMut:!0,isSigner:!1},{name:"vault1",isMut:!0,isSigner:!1},{name:"recipientWallet0",isMut:!0,isSigner:!1},{name:"recipientWallet1",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"amount0Requested",type:"u64"},{name:"amount1Requested",type:"u64"}]},{name:"swap",accounts:[{name:"signer",isMut:!1,isSigner:!0},{name:"inputTokenAccount",isMut:!0,isSigner:!1},{name:"outputTokenAccount",isMut:!0,isSigner:!1},{name:"inputVault",isMut:!0,isSigner:!1},{name:"outputVault",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"factoryState",isMut:!1,isSigner:!1},{name:"poolState",isMut:!0,isSigner:!1},{name:"lastObservationState",isMut:!0,isSigner:!1},{name:"callbackHandler",isMut:!1,isSigner:!1}],args:[{name:"amountSpecified",type:"i64"},{name:"sqrtPriceLimitX32",type:"u64"}]},{name:"mintTokenizedPosition",accounts:[{name:"minter",isMut:!0,isSigner:!0},{name:"recipient",isMut:!1,isSigner:!1},{name:"factoryState",isMut:!1,isSigner:!1},{name:"nftMint",isMut:!0,isSigner:!0},{name:"nftAccount",isMut:!0,isSigner:!1},{name:"poolState",isMut:!0,isSigner:!1},{name:"corePositionState",isMut:!0,isSigner:!1},{name:"tickLowerState",isMut:!0,isSigner:!1},{name:"tickUpperState",isMut:!0,isSigner:!1},{name:"bitmapLowerState",isMut:!0,isSigner:!1},{name:"bitmapUpperState",isMut:!0,isSigner:!1},{name:"tokenizedPositionState",isMut:!0,isSigner:!1},{name:"tokenAccount0",isMut:!0,isSigner:!1},{name:"tokenAccount1",isMut:!0,isSigner:!1},{name:"vault0",isMut:!0,isSigner:!1},{name:"vault1",isMut:!0,isSigner:!1},{name:"lastObservationState",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"coreProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1}],args:[{name:"amount0Desired",type:"u64"},{name:"amount1Desired",type:"u64"},{name:"amount0Min",type:"u64"},{name:"amount1Min",type:"u64"},{name:"deadline",type:"i64"}]},{name:"addMetaplexMetadata",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"factoryState",isMut:!1,isSigner:!1},{name:"nftMint",isMut:!0,isSigner:!1},{name:"tokenizedPositionState",isMut:!1,isSigner:!1},{name:"metadataAccount",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"metadataProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"increaseLiquidity",accounts:[{name:"payer",isMut:!1,isSigner:!0},{name:"factoryState",isMut:!1,isSigner:!1},{name:"tokenizedPositionState",isMut:!0,isSigner:!1},{name:"poolState",isMut:!0,isSigner:!1},{name:"corePositionState",isMut:!0,isSigner:!1},{name:"tickLowerState",isMut:!0,isSigner:!1},{name:"tickUpperState",isMut:!0,isSigner:!1},{name:"bitmapLowerState",isMut:!0,isSigner:!1},{name:"bitmapUpperState",isMut:!0,isSigner:!1},{name:"tokenAccount0",isMut:!0,isSigner:!1},{name:"tokenAccount1",isMut:!0,isSigner:!1},{name:"vault0",isMut:!0,isSigner:!1},{name:"vault1",isMut:!0,isSigner:!1},{name:"lastObservationState",isMut:!0,isSigner:!1},{name:"coreProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"amount0Desired",type:"u64"},{name:"amount1Desired",type:"u64"},{name:"amount0Min",type:"u64"},{name:"amount1Min",type:"u64"},{name:"deadline",type:"i64"}]},{name:"decreaseLiquidity",accounts:[{name:"ownerOrDelegate",isMut:!1,isSigner:!0},{name:"nftAccount",isMut:!1,isSigner:!1},{name:"tokenizedPositionState",isMut:!0,isSigner:!1},{name:"factoryState",isMut:!1,isSigner:!1},{name:"poolState",isMut:!0,isSigner:!1},{name:"corePositionState",isMut:!0,isSigner:!1},{name:"tickLowerState",isMut:!0,isSigner:!1},{name:"tickUpperState",isMut:!0,isSigner:!1},{name:"bitmapLowerState",isMut:!0,isSigner:!1},{name:"bitmapUpperState",isMut:!0,isSigner:!1},{name:"lastObservationState",isMut:!0,isSigner:!1},{name:"coreProgram",isMut:!1,isSigner:!1}],args:[{name:"liquidity",type:"u64"},{name:"amount0Min",type:"u64"},{name:"amount1Min",type:"u64"},{name:"deadline",type:"i64"}]},{name:"collectFromTokenized",accounts:[{name:"ownerOrDelegate",isMut:!1,isSigner:!0},{name:"nftAccount",isMut:!1,isSigner:!1},{name:"tokenizedPositionState",isMut:!0,isSigner:!1},{name:"factoryState",isMut:!1,isSigner:!1},{name:"poolState",isMut:!0,isSigner:!1},{name:"corePositionState",isMut:!0,isSigner:!1},{name:"tickLowerState",isMut:!0,isSigner:!1},{name:"tickUpperState",isMut:!0,isSigner:!1},{name:"bitmapLowerState",isMut:!0,isSigner:!1},{name:"bitmapUpperState",isMut:!0,isSigner:!1},{name:"lastObservationState",isMut:!0,isSigner:!1},{name:"vault0",isMut:!0,isSigner:!1},{name:"vault1",isMut:!0,isSigner:!1},{name:"recipientWallet0",isMut:!0,isSigner:!1},{name:"recipientWallet1",isMut:!0,isSigner:!1},{name:"coreProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"amount0Max",type:"u64"},{name:"amount1Max",type:"u64"}]},{name:"exactInputSingle",accounts:[{name:"signer",isMut:!1,isSigner:!0},{name:"factoryState",isMut:!1,isSigner:!1},{name:"poolState",isMut:!0,isSigner:!1},{name:"inputTokenAccount",isMut:!0,isSigner:!1},{name:"outputTokenAccount",isMut:!0,isSigner:!1},{name:"inputVault",isMut:!0,isSigner:!1},{name:"outputVault",isMut:!0,isSigner:!1},{name:"lastObservationState",isMut:!0,isSigner:!1},{name:"coreProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"deadline",type:"i64"},{name:"amountIn",type:"u64"},{name:"amountOutMinimum",type:"u64"},{name:"sqrtPriceLimitX32",type:"u64"}]},{name:"exactInput",accounts:[{name:"signer",isMut:!1,isSigner:!0},{name:"factoryState",isMut:!1,isSigner:!1},{name:"inputTokenAccount",isMut:!0,isSigner:!1},{name:"coreProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"deadline",type:"i64"},{name:"amountIn",type:"u64"},{name:"amountOutMinimum",type:"u64"},{name:"additionalAccountsPerPool",type:"bytes"}]}],accounts:[{name:"factoryState",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"owner",type:"publicKey"},{name:"feeProtocol",type:"u8"}]}},{name:"feeState",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"fee",type:"u32"},{name:"tickSpacing",type:"u16"}]}},{name:"observationState",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"index",type:"u16"},{name:"blockTimestamp",type:"u32"},{name:"tickCumulative",type:"i64"},{name:"secondsPerLiquidityCumulativeX32",type:"u64"},{name:"initialized",type:"bool"}]}},{name:"poolState",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"token0",type:"publicKey"},{name:"token1",type:"publicKey"},{name:"fee",type:"u32"},{name:"tickSpacing",type:"u16"},{name:"liquidity",type:"u64"},{name:"sqrtPriceX32",type:"u64"},{name:"tick",type:"i32"},{name:"observationIndex",type:"u16"},{name:"observationCardinality",type:"u16"},{name:"observationCardinalityNext",type:"u16"},{name:"feeGrowthGlobal0X32",type:"u64"},{name:"feeGrowthGlobal1X32",type:"u64"},{name:"protocolFeesToken0",type:"u64"},{name:"protocolFeesToken1",type:"u64"},{name:"unlocked",type:"bool"}]}},{name:"positionState",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"liquidity",type:"u64"},{name:"feeGrowthInside0LastX32",type:"u64"},{name:"feeGrowthInside1LastX32",type:"u64"},{name:"tokensOwed0",type:"u64"},{name:"tokensOwed1",type:"u64"}]}},{name:"positionManagerState",type:{kind:"struct",fields:[{name:"bump",type:"u8"}]}},{name:"swapRouterState",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"core",type:"publicKey"},{name:"amountInCached",type:"u64"}]}},{name:"tickState",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"tick",type:"i32"},{name:"liquidityNet",type:"i64"},{name:"liquidityGross",type:"u64"},{name:"feeGrowthOutside0X32",type:"u64"},{name:"feeGrowthOutside1X32",type:"u64"},{name:"tickCumulativeOutside",type:"i64"},{name:"secondsPerLiquidityOutsideX32",type:"u64"},{name:"secondsOutside",type:"u32"}]}},{name:"tickBitmapState",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"wordPos",type:"i16"},{name:"word",type:{array:["u64",4]}}]}},{name:"tokenizedPositionState",type:{kind:"struct",fields:[{name:"bump",type:"u8"},{name:"mint",type:"publicKey"},{name:"poolId",type:"publicKey"},{name:"tickLower",type:"i32"},{name:"tickUpper",type:"i32"},{name:"liquidity",type:"u64"},{name:"feeGrowthInside0LastX32",type:"u64"},{name:"feeGrowthInside1LastX32",type:"u64"},{name:"tokensOwed0",type:"u64"},{name:"tokensOwed1",type:"u64"}]}}],events:[{name:"OwnerChanged",fields:[{name:"oldOwner",type:"publicKey",index:!1},{name:"newOwner",type:"publicKey",index:!1}]},{name:"SetFeeProtocolEvent",fields:[{name:"feeProtocolOld",type:"u8",index:!1},{name:"feeProtocol",type:"u8",index:!1}]},{name:"FeeAmountEnabled",fields:[{name:"fee",type:"u32",index:!1},{name:"tickSpacing",type:"u16",index:!1}]},{name:"IncreaseObservationCardinalityNext",fields:[{name:"observationCardinalityNextOld",type:"u16",index:!1},{name:"observationCardinalityNextNew",type:"u16",index:!1}]},{name:"PoolCreatedAndInitialized",fields:[{name:"token0",type:"publicKey",index:!1},{name:"token1",type:"publicKey",index:!1},{name:"fee",type:"u32",index:!1},{name:"tickSpacing",type:"u16",index:!1},{name:"poolState",type:"publicKey",index:!1},{name:"sqrtPriceX32",type:"u64",index:!1},{name:"tick",type:"i32",index:!1}]},{name:"CollectProtocolEvent",fields:[{name:"poolState",type:"publicKey",index:!1},{name:"sender",type:"publicKey",index:!1},{name:"recipientWallet0",type:"publicKey",index:!1},{name:"recipientWallet1",type:"publicKey",index:!1},{name:"amount0",type:"u64",index:!1},{name:"amount1",type:"u64",index:!1}]},{name:"SwapEvent",fields:[{name:"poolState",type:"publicKey",index:!1},{name:"sender",type:"publicKey",index:!1},{name:"tokenAccount0",type:"publicKey",index:!1},{name:"tokenAccount1",type:"publicKey",index:!1},{name:"amount0",type:"i64",index:!1},{name:"amount1",type:"i64",index:!1},{name:"sqrtPriceX32",type:"u64",index:!1},{name:"liquidity",type:"u64",index:!1},{name:"tick",type:"i32",index:!1}]},{name:"MintEvent",fields:[{name:"poolState",type:"publicKey",index:!1},{name:"sender",type:"publicKey",index:!1},{name:"owner",type:"publicKey",index:!1},{name:"tickLower",type:"i32",index:!1},{name:"tickUpper",type:"i32",index:!1},{name:"amount",type:"u64",index:!1},{name:"amount0",type:"u64",index:!1},{name:"amount1",type:"u64",index:!1}]},{name:"BurnEvent",fields:[{name:"poolState",type:"publicKey",index:!1},{name:"owner",type:"publicKey",index:!1},{name:"tickLower",type:"i32",index:!1},{name:"tickUpper",type:"i32",index:!1},{name:"amount",type:"u64",index:!1},{name:"amount0",type:"u64",index:!1},{name:"amount1",type:"u64",index:!1}]},{name:"CollectEvent",fields:[{name:"poolState",type:"publicKey",index:!1},{name:"owner",type:"publicKey",index:!1},{name:"tickLower",type:"i32",index:!1},{name:"tickUpper",type:"i32",index:!1},{name:"amount0",type:"u64",index:!1},{name:"amount1",type:"u64",index:!1}]},{name:"IncreaseLiquidityEvent",fields:[{name:"tokenId",type:"publicKey",index:!1},{name:"liquidity",type:"u64",index:!1},{name:"amount0",type:"u64",index:!1},{name:"amount1",type:"u64",index:!1}]},{name:"DecreaseLiquidityEvent",fields:[{name:"tokenId",type:"publicKey",index:!1},{name:"liquidity",type:"u64",index:!1},{name:"amount0",type:"u64",index:!1},{name:"amount1",type:"u64",index:!1}]},{name:"CollectTokenizedEvent",fields:[{name:"tokenId",type:"publicKey",index:!1},{name:"recipientWallet0",type:"publicKey",index:!1},{name:"recipientWallet1",type:"publicKey",index:!1},{name:"amount0",type:"u64",index:!1},{name:"amount1",type:"u64",index:!1}]}],errors:[{code:6e3,name:"LOK",msg:"LOK"},{code:6001,name:"ZeroMintAmount",msg:"Minting amount should be greater than 0"},{code:6002,name:"TLU",msg:"TLU"},{code:6003,name:"TMS",msg:"TMS"},{code:6004,name:"TLM",msg:"TLM"},{code:6005,name:"TUM",msg:"TUM"},{code:6006,name:"M0",msg:"M0"},{code:6007,name:"M1",msg:"M1"},{code:6008,name:"OS",msg:"OS"},{code:6009,name:"AS",msg:"AS"},{code:6010,name:"SPL",msg:"SPL"},{code:6011,name:"IIA",msg:"IIA"},{code:6012,name:"NP",msg:"NP"},{code:6013,name:"LO",msg:"LO"},{code:6014,name:"R",msg:"R"},{code:6015,name:"T",msg:"T"},{code:6016,name:"LS",msg:"LS"},{code:6017,name:"LA",msg:"LA"},{code:6018,name:"TransactionTooOld",msg:"Transaction too old"},{code:6019,name:"PriceSlippageCheck",msg:"Price slippage check"},{code:6020,name:"NotApproved",msg:"Not approved"},{code:6021,name:"TooLittleReceived",msg:"Too little received"}]},exports.LiquidityMath=L,exports.NoTickDataProvider=G,exports.OBSERVATION_SEED=q,exports.POOL_SEED=w,exports.POSITION_SEED=T,exports.Pool=z,exports.Position=Z,exports.Route=$,exports.SqrtPriceMath=E,exports.SwapMath=N,exports.TICK_SEED=I,exports.TICK_SPACINGS=f,exports.Tick=function(t){var e=t.index,n=t.liquidityGross,a=t.liquidityNet;e>=K.MIN_TICK&&e<=K.MAX_TICK||r(!1),this.index=e,this.liquidityGross=i.BigInt(n),this.liquidityNet=i.BigInt(a)},exports.TickList=et,exports.TickMath=K,exports.Trade=ot,exports.buildTick=function(t,e,n){return((t<<8)+e)*n},exports.computePoolAddress=R,exports.encodeSqrtRatioX32=V,exports.generateBitmapWord=function(t){return t[0].add(t[1].shln(64)).add(t[2].shln(128)).add(t[3].shln(192))},exports.i16ToSeed=function(t){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,t,!1),new Uint8Array(e)},exports.i32ToSeed=function(t){var e=new ArrayBuffer(4);return new DataView(e).setInt32(0,t,!1),new Uint8Array(e)},exports.isSorted=J,exports.lsb=B,exports.maxLiquidityForAmounts=Q,exports.msb=U,exports.nearestUsableTick=function(t,e){Number.isInteger(t)&&Number.isInteger(e)||r(!1),e>0||r(!1),t>=K.MIN_TICK&&t<=K.MAX_TICK||r(!1);var n=Math.round(t/e)*e;return n<K.MIN_TICK?n+e:n>K.MAX_TICK?n-e:n},exports.nextInitializedBit=function(t,e,n){if(n){var i=new a.BN(1).shln(e).subn(1).add(new a.BN(1).shln(e)),r=t.and(i),o=!r.eqn(0);return{next:o?U(r):0,initialized:o}}var u=new a.BN(1).shln(e).subn(1).notn(256),s=t.and(u),c=!s.eqn(0);return{next:c?B(s):255,initialized:c}},exports.priceToClosestTick=function(t){var e=t.baseCurrency.sortsBefore(t.quoteCurrency),n=e?V(t.numerator,t.denominator):V(t.denominator,t.numerator),i=K.getTickAtSqrtRatio(n),r=Y(t.baseCurrency,t.quoteCurrency,i+1);return e?t.lessThan(r)||i++:t.greaterThan(r)||i++,i},exports.snapshotCumulativesInside=function(t){var e=t.poolState,n=t.tickLower,i=t.tickUpper,r=t.latestObservation,a=t.time;if(e.tick.lt(n.tick))return{tickCumulativeInside:n.tickCumulativeOutside.sub(i.tickCumulativeOutside),secondsPerLiquidityInsideX32:n.secondsPerLiquidityOutsideX32.sub(i.secondsPerLiquidityOutsideX32),secondsInside:n.secondsOutside.sub(i.secondsOutside)};if(e.tick.lt(i.tick)){var o=r.blockTimestamp.eq(a)?r:nt({observation:r,blockTimestamp:a,tick:e.tick,liquidity:e.liquidity}),u=o.secondsPerLiquidityCumulativeX32;return{tickCumulativeInside:o.tickCumulative.sub(n.tickCumulativeOutside).sub(i.tickCumulativeOutside),secondsPerLiquidityInsideX32:u.sub(n.secondsPerLiquidityOutsideX32).sub(i.secondsPerLiquidityOutsideX32),secondsInside:a.sub(n.secondsOutside).sub(i.secondsOutside)}}return{tickCumulativeInside:i.tickCumulativeOutside.sub(n.tickCumulativeOutside),secondsPerLiquidityInsideX32:i.secondsPerLiquidityOutsideX32.sub(n.secondsPerLiquidityOutsideX32),secondsInside:i.secondsOutside.sub(n.secondsOutside)}},exports.tickPosition=function(t){return{wordPos:t>>8,bitPos:t%256&255}},exports.tickToPrice=Y,exports.toHex=function(t){var e=i.BigInt(t).toString(16);return e.length%2!=0&&(e="0"+e),"0x"+e},exports.tradeComparator=at,exports.transformObservation=nt,exports.u16ToSeed=function(t){var e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t,!1),new Uint8Array(e)},exports.u32ToSeed=O;
//# sourceMappingURL=cykura-sdk.cjs.production.min.js.map
